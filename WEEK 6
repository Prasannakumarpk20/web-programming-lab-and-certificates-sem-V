WEEK-6: 
TYPE THE CODE: 
//index.js 
const express=require("express"); 
const mongoose=require("mongoose"); 
const router=require("./routers/taskRoutes"); 
const app=express(); 
app.use(express.json()); 
mongoose.connect("mongodb://127.0.0.1:27017/taskdb",{ 
useNewUrlParser:true, 
useUnifiedTopology:true 
}) 
.then(()=>{console.log("connected")}) 
.catch((err)=>{console.log("Not connected "+err.message)}); 
app.use("/tasks",router); 
module.exports=app; 
app.listen(8080,()=>{ 
console.log("server started at port 8080"); 
}) 
//taskModel.js 
 
const mongoose=require("mongoose"); 
 
const task_schema=new mongoose.Schema({ 
    title:{ 
        type:String, 
        required:true 
    }, 
    completed:{ 
        type:Boolean, 
        default:false 
    } 
}); 
 
const Task=mongoose.model('Task',task_schema); 
 
module.exports=Task; 
 
 
//taskController.js 
 
const Task=require("../models/taskModel.js"); 
 
const createTask=async(req,res)=>{ 
 
    try{ 
        const {title,completed}=req.body; 
 
        const newTask=new Task({title,completed}); 
 
        const saved=await newTask.save(); 
 
        res.status(201).json(saved); 
    } 
 
    catch(err){ 
 
        res.status(500).json({message:err.message}); 
 
    } 
} 
 
 
const getAllTasks=async(req,res)=>{ 
    try{ 
        const tasks=await Task.find(); 
        res.status(200).json(tasks); 
    } 
    catch(err){ 
        res.status(500).json({message:err.message}) 
    } 
} 
 
const getTaskById=async(req,res)=>{ 
    try{ 
        const taskid=await Task.findById(req.params.id); 
        if(!taskid){ 
            res.status(404).json({message:"Task not found"}); 
            return; 
        } 
        res.status(200).json(taskid); 
    } 
    catch(err){ 
        res.status(500).json({message:err.message}) 
    } 
 
} 
 
module.exports= {createTask,getAllTasks,getTaskById}; 
 
 
 
//taskRouter.js 
 
const express=require("express"); 
const { createTask,getAllTasks,getTaskById } =require( "../controllers/taskController.js"); 
 
const router=express.Router(); 
 
router.post("/",createTask); 
router.get("/",getAllTasks); 
router.get("/:id",getTaskById); 
 
module.exports= router; 
FIX THE CODE: 
//itemModel.js 
const mongoose = require('mongoose'); 
const itemSchema = new mongoose.Schema({ 
name: { 
type:String, 
required: true 
}, 
quantity: { 
type: Number, 
required:true 
} 
}); 
const Item = mongoose.model('Item', itemSchema); 
module.exports = Item; 
//itemController.js 
 
const Item = require('../models/itemModel.js'); 
 
const createItem = async (req, res) => { 
  const { name, quantity } = req.body; 
 
  if (!name || quantity == null) { 
    return res.status(400).json({ message: 'Name and quantity is required' }); 
  } 
 
  try { 
    const newItem = new Item({ 
      name, 
      quantity 
    }); 
 
    const savedItem = await newItem.save(); 
    res.status(201).json(savedItem); 
  } catch (err) { 
    res.status(500).json({ message: err.message }); 
  } 
}; 
 
const getAllItems = async (req, res) => { 
  try { 
    const items = await Item.find(); 
    res.status(200).json(items); 
  } catch (err) { 
    res.status(500).json({ message: err.message }); 
  } 
}; 
 
module.exports = { 
  createItem, 
  getAllItems 
}; 
 
 
 
 
 
 
//itemRouter.js 
const express = require('express'); 
const { createItem, getAllItems } = require('../controllers/itemController.js'); 
const router = express.Router(); 
router.post('/', createItem); 
router.get( ', getAllItems); 
module.exports = router; 
//index.js 
const express = require('express'); 
const mongoose = require('mongoose'); 
const itemRoutes = require("./routers/itemRouter.js"); 
const app = express(); 
app.use(express.json()); 
mongoose.connect('mongodb://127.0.0.1:27017/itemdb', { 
useNewUrlParser: true, 
useUnifiedTopology: true 
}) 
.then(() => console.log('Connected to MongoDB')) 
.catch(err => console.log(err)); 
app.use('/items', itemRoutes); 
const port = '8080'; 
app.listen(port, () => { 
console.log('Server is running on port ' + port); 
}); 
PRACTICE AT HOME -1 
//productController.js 
const Product=require("../models/productModel.js"); 
const createProduct=async(req,res,next)=>{ 
try{ 
const {name,price,category}=req.body; 
const newproduct=new Product({name,price,category}); 
const saved=await newproduct.save(); 
res.status(201).json(saved);} 
catch(err){ 
next(err); 
} 
} 
const getAllProducts=async(req,res,next)=>{ 
try{ 
const products=await Product.find(); 
res.status(200).json(products); 
} 
catch(err){ 
next(err); 
} 
} 
module.exports={createProduct,getAllProducts}; 
//errorHandler.js 
const errorHandler=(err,req,res,next)=>{ 
console.log(err.stack); 
const statusCode=res.statusCode!==200? res.statusCode:500; 
res.status(500).json({error:{message:err.message,stack:err.stack}}) 
} 
module.exports=errorHandler; 
//productRoutes.js 
const express=require("express"); 
const 
{createProduct,getAllProducts}=require("../controllers/productController.j
 s") 
const router=express.Router(); 
router.post("/",createProduct); 
router.get("/",getAllProducts); 
module.exports=router; 
//index.js 
const express=require("express"); 
const mongoose=require("mongoose"); 
const errorHandler=require("./middlewares/errorHandler.js"); 
const productRoutes=require("./routers/productRoutes.js"); 
const app=express(); 
app.use(express.json()); 
mongoose.connect("mongodb://127.0.0.1:27017/productDB",{ 
useNewUrlParser:true, 
useUnifiedTopology:true 
}); 
app.use("/products",productRoutes); 
app.use(errorHandler); 
app.listen(8080,()=>{ 
console.log("server started at port 8080"); 
}) 
//productModel.js 
const mongoose=require("mongoose"); 
const product_schema=new mongoose.Schema({ 
name:{ 
type:String, 
required:true 
}, 
price:{ 
type:Number, 
required:true 
}, 
category:{ 
type:String, 
required:true 
}, 
inStock:{ 
default:false 
} 
}) 
const Product=mongoose.model("Product",product_schema); 
module.exports=Product; 
PRACTICE AT HOME -2 
//movieController.js 
const Movie=require("../models/movieModel.js"); 
const createMovie=async(req,res)=>{ 
try{ 
const {title,director,releaseYear,genre}=req.body; 
const newMovie=new Movie({title,director,releaseYear,genre}); 
const saved=await newMovie.save(); 
res.status(201).json(saved); 
} 
catch(err){ 
res.status(500).json({message:err.message}); 
} 
} 
const getAllMovies=async(req,res)=>{ 
try{ 
const movies=await Movie.find(); 
res.status(200).json(movies); 
} 
catch(err){ 
res.status(500).json({message:err.message}); 
} 
} 
const getMovieById=async(req,res)=>{ 
try{ 
const movieId=await Movie.findById(req.params.id); 
if(movieId){ 
res.status(200).json(movieId); 
return; 
} 
res.status(404).json({message:"Movie not found"}); 
} 
catch(err){ 
res.status(500).json({message:err.message}); 
} 
} 
const updateMovie=async(req,res)=>{ 
try{ 
const updated_data=await Movie.findByIdAndUpdate(req.params.id, 
req.body,{new:true,runValidators:true}); 
if(updated_data){ 
res.status(200).json(updated_data); 
return; 
} 
res.status(404).json({message:"Movie not found"}); 
} 
catch(err){ 
res.status(500).json({message:err.message}); 
} 
} 
const deleteMovie=async(req,res)=>{ 
try{ 
const del_data=await Movie.findByIdAndDelete(req.params.id); 
if(del_data){ 
res.status(200).json({message:"Movie deleted successfully"}); 
return; 
} 
res.status(404).json({message:"Movie not found"}); 
} 
catch(err){ 
res.status(500).json({message:err.message}); 
} 
} 
module.exports={createMovie,getAllMovies,getMovieById,updateMovie,deleteMo
 vie}; 
//movieModel.js 
const mongoose=require("mongoose"); 
const movie_schema=new mongoose.Schema({ 
title:{type:String, 
required:true}, 
director:{type:String, 
required:true}, 
releaseYear:{type:Number, 
required:true 
}, 
genre:{type:String, 
required:true 
} 
}); 
const Movie=mongoose.model("Movie",movie_schema); 
module.exports=Movie; 
//movieRoutes.js 
const express=require("express"); 
const{createMovie,getAllMovies,getMovieById,updateMovie,deleteMovie}=requi
 re("../controllers/movieController.js"); 
const router=express.Router(); 
router.post("/",createMovie); 
router.get("/",getAllMovies); 
router.get("/:id",getMovieById); 
router.put("/:id",updateMovie); 
router.delete("/:id",deleteMovie); 
module.exports=router 
//index.js 
const express=require("express"); 
const mongoose =require("mongoose"); 
const app=express(); 
const router=require("./routers/movieRoutes.js"); 
app.use(express.json()); 
const uri="mongodb://127.0.0.1:27017/movieDB"; 
mongoose.connect(uri,{ 
useNewUrlParser:true,useUnifiedTopology:true 
}) 
.then(()=>{console.log("Connected")}) 
.catch((err)=>{console.log("Not Connected")}); 
app.use("/movies",router); 
app.listen(8080,()=>{ 
console.log("Server started at port 8080"); 
}) 
CHALLENGE YOURSELF 
//customerController.js  
const Customer=require("../models/customerModel.js"); 
const createCustomer=async(req,res,next)=>{ 
try{ 
const {name,email,phone,isActive}=req.body; 
if(!name || !email|| !phone){ 
res.status(404).json({message:'Name, email, and phone are 
required'}); 
} 
return; 
const newCustomer=new Customer({ 
name,email,phone,isActive 
}); 
const saved=await newCustomer.save(); 
res.status(201).json(saved); 
} 
catch(err){     
next(err); 
} 
} 
const getAllCustomers=async(req,res,next)=>{ 
try{ 
const c_data=await Customer.find(); 
res.status(200).json(c_data); 
} 
catch(err){ 
next(err); 
} 
} 
const updateCustomer=async(req,res,next)=>{ 
try{ 
const {id}=req.params.id; 
const {name, email, phone}=req.body; 
if(!name || !email|| !phone){ 
res.status(404).json({message:'Name, email, and phone are 
required to update the customer'}); 
return; 
} 
const u_data=await Customer.findByIdAndUpdate(req.params.id, 
req.body,{new:true}); 
if(u_data){ 
res.status(200).json(u_data); 
return; 
} 
res.status(404).json({message:"Customer not found"}); 
} 
catch(err){ 
next(err); 
} 
} 
module.exports={createCustomer,getAllCustomers,updateCustomer}; 
//errorHandler.js 
const errorHandler=(err,req,res,next)=>{ 
console.log(err.stack); 
const statusCode=res.statusCode!==200?res.statusCode:500; 
res.status(statusCode).json({error:{ 
message:err.message,stack:err.stack 
}}); 
} 
module.exports=errorHandler; 
//customerModel.js 
const mongoose=require("mongoose"); 
const customer_schema=new mongoose.Schema({ 
name:{type:String,required:true}, 
email:{type:String,required:true}, 
phone:{type:String,required:true}, 
isActive:{type:Boolean,default:true}, 
}); 
const Customer=mongoose.model("Customer",customer_schema) 
module.exports=Customer; 
//customerRoutes.js 
const express=require("express"); 
const router=express.Router(); 
const{createCustomer,getAllCustomers,updateCustomer}=require("../controlle
 rs/customerController.js"); 
router.post("/",createCustomer); 
router.get("/",getAllCustomers); 
router.put("/:id",updateCustomer); 
module.exports=router; 
//index.js 
const express=require("express"); 
const router=require("./routers/customerRoutes.js"); 
const mongoose = require("mongoose"); 
const errorHandler = require("./middlewares/errorHandler.js"); 
const app=express(); 
app.use(express.json()); 
mongoose.connect("mongodb://127.0.0.1:27017/customersDB",{ 
useNewUrlParser:true,useUnifiedTopology:true 
}) 
.then(()=>{console.log("connected")}) 
.catch((err)=>{console.log("Not connected "+err.message)}); 
app.use("/customers",router); 
app.use(errorHandler); 
app.listen(8080,()=>{ 
console.log("server started at port 8080"); 
}) 
